# 8주차 — 무선센서네트워크(WSN) & 무선 프로토콜 정리

## 0) 강의 개요 · 목차

* **주제:** 사물인터넷 8주차 (인하공업전문대학 컴퓨터정보과 김한결)
* **목차:** WSN(특징, 6LoWPAN) → Wi-Fi(MAC service set, MAC data frame, CSMA/CA) → ZigBee(물리계층, MAC 슈퍼프레임, 분산 주소 할당 Cskip(d), 라우팅: 트리·메시)

---

## 1) WSN (Wireless Sensor Network)

### 1-1. 개념/구성

* **WSN 개념** 및 **WSN 구성**(센서 노드들의 무선 연결, 게이트웨이·서버 등) 소개 슬라이드 구성.

### 1-2. 6LoWPAN

* **6LoWPAN:** ZigBee와 유사한 스택 맥락의 **IPv6 over 저전력 WPAN** 개요. (도식 출처: ResearchGate)

---

## 2) Wi-Fi

### 2-1. IEEE 표준 맥락

* **IEEE**: 전기/전자/컴퓨터/IT 분야 최대 전문가 단체. **표준 개발·교육·네트워킹·연구**를 담당. (표 출처: haru21 블로그)

### 2-2. Wi-Fi 구성

* **표준화:** IEEE 802.11 Working Group.
* **구성 요소:** **AP(유무선 공유기)** + **STA(노트북·스마트폰)**. (문헌: *데이터 통신과 네트워킹*, 2005)

### 2-3. Service Set

* **BSS (Basic Service Set):** AP 없으면 **ad hoc**, AP 있으면 **infrastructure**.
* **ESS (Extended Service Set):** 둘 이상의 BSS 결합한 확장 셋.

### 2-4. MAC 방식

* **PCF:** 중앙집중식 **Polling**(옵션).
* **DCF:** **CSMA/CA** 사용(스테이션 측).

### 2-5. MAC Data Frame · 주소 체계

* **MAC Data Frame** 구성 개요(프레임 필드).
* **주소 체계:** 프레임 내 주소/필드 체계 설명.

### 2-6. CSMA/CA (802.11) vs CSMA/CD (802.3)

* **CSMA/CA:**

  * **CS**: 채널 사용 감지, **MA**: 비어있으면 사용, **CA**: **충돌 회피**—**RTS/CTS** 활용.
* **CSMA/CD:** 이더넷—충돌 **감지** 후 중단·백오프·재전송. (무선은 송신 중 수신이 어려워 CD 구현 난해)

### 2-7. Collision & Hidden Terminal

* **Collision:** 두 노드가 같은 시간에 같은 노드로 전송 → 수신 실패 → **랜덤 백오프**. **RTS/CTS**로 충돌 확률 감소.
* **Hidden Terminal 문제:** A는 B·C와 통신 가능하지만 **B와 C는 서로 감지 불가** → **RTS/CTS**로 보완.

### 2-8. 일반적 CSMA-CA 절차

* **경합 기반**:

  1. 채널 감시 → 사용 중이면 대기
  2. 비면 **DIFS** 후 **랜덤 백오프**
  3. 감시·감소(타 노드 송신 시 정지)
  4. **RTS→CTS→DATA→ACK** 순서로 전송/확인
* **RTS-CTS-DATA-ACK** 시퀀스: CTS 미수신 시 대기 후 **RTS 재전송**.

### 2-9. CSMA-CD 보충

* 이더넷의 **충돌 감지** 방식, **저가격 구현 장점** vs **전송 지연 가능성** 단점. 무선에서 구현 어렵다(송신 중 수신 곤란).

---

## 3) ZigBee

### 3-1. 스택(프로토콜 집합) 개념

* **스택:** 프로토콜/소프트웨어 집합. **ZigBee 스택**은 ZigBee 규격에 따른 구현.

### 3-2. 계층 구조와 역할

* **PHY:** **DSSS** 변조로 무선 직접 송수신
* **MAC:** 다수 기기 **충돌 회피**
* **NWK:** 노드들로 **네트워크 형성**
* **APS:** 애플리케이션이 네트워크 사용하도록 지원
* **APL:** 응용 프로그램 동작

### 3-3. IEEE 802.15.4 PHY 특징

* 무선 직접 송수신, **3개 밴드·27채널**, **DSSS**, **빠른 응답**, **저전력 수면기 지원**.
* **채널 구성:** “3개 밴드에 27개 채널 사용.”
* **2.4GHz 중첩 이슈:**

  * Wi-Fi와 일부 채널 겹침
  * **채널 25, 26**은 독자적이며 겹치지 않음
  * **채널 15, 20**도 Wi-Fi 권고 채널 선택 시 비중첩 가능

### 3-4. DSSS(직접 시퀀스 확산) 개념

* 공통의 **슈도 랜덤(+1/−1) 시퀀스**를 데이터에 곱해 **스펙트럼 확산** → 수신 시 같은 시퀀스로 복원(**CDMA**에서도 사용).

### 3-5. MAC 계층 개요

* **기기 유형**

  * **NC**(Network Coordinator): 네트워크 관리
  * **FFD**(Full Function Device)
  * **RFD**(Reduced Function Device)
* **통신 형태**

  * **Non-Beacon:** **Non-slotted CSMA-CA**, 확인응답(Ack) 사용
  * **Beacon 사용:** **Slotted CSMA-CA**, **슈퍼프레임** 사용(백오프 시간 단위=슬롯)
* **장단점**

  * **Non-Beacon:** 간단함 / 수면 기능 제공이 쉽지 않음
  * **Beacon:** 슬롯 기반·수면 기능 용이 / 복잡함

### 3-6. 슈퍼프레임 구조

* **구성:** 최대 **16슬롯**, **Beacon + CAP(경쟁) + CFP(비경쟁)**, **비활성화 구간** 가능, **항상 Beacon으로 시작**(PAN 코디네이터 송신)
* **슈퍼프레임 길이:** **최소 15ms ~ 최대 245초**
* **CAP/CFP 동작:**

  * CAP: 슬롯 시간에 맞춘 송수신(경쟁)
  * CFP: **GTS(보장 슬롯)** 예약으로 경쟁 없이 송수신(**0~7개 슬롯** 할당 가능)
  * Beacon: 시간 동기·GTS 할당 정보 제공
* **비활성화 구간:** 전력 절감을 위해 송수신기(및 필요 시 프로세서 기능) **오프**.

### 3-7. MAC 프레임 종류(4가지)

* **Beacon / Data / Acknowledgement / MAC Command**

  * 상위 계층 전달 여부에 차이(데이터·비콘은 상위 전달, 확인 프레임은 상위 전달 안 됨 등).

### 3-8. Data Frame 구성 요소

* **Frame Control**(타입·주소 형식 등), **Sequence Number**(일련번호), **Payload**(실데이터), **FCS**(에러 체크).

### 3-9. MAC 주소 체계

* **PAN ID + 주소**(2바이트 또는 8바이트).

  * 2B: 코디네이터 할당, 8B: 제조사 할당(Octet=Byte).
* **표현 형식 예:**

  * 같은 네트워크: **목적지 주소(2) + 근원지 주소(2) = 4B**
  * 다른 네트워크: **목적지 PAN(2)+주소(2) + 근원지 PAN(2)+주소(2) = 8B**
  * 8바이트 주소 사용 시 **최대 20B** 조합도 가능
  * 실제 사용/생략(0)은 **Frame Control**에 표시됨

### 3-10. **분산 주소 할당 기법**(Distributed Address Assignment)

* **개념:** 16비트 주소를 **부모 노드**가 정해진 식으로 자식에게 부여(**모든 라우터가 주소 할당 가능** → **분산 방식**).
* **비교:** 중앙집중형은 제어 트래픽 과다, **분산형은 네트워크 트래픽 감소 장점**.
* **Cskip(d) 식**(깊이에 따른 주소 부분 블록 크기):
  [
  Cskip(d) = \frac{1 + C_m - R_m - C_m \cdot R_m^{(L_m - d - 1)}}{1 - R_m}
  ]

  * **Cm:** 최대 자식 수
  * **Lm:** 트리 최대 깊이
  * **Rm:** 자식으로 가질 수 있는 최대 ZigBee 라우터 수
  * **d:** 현재 노드 깊이
  * **Cskip(d):** 깊이 d 노드가 가질 수 있는 주소 부분 블록 크기
  * **n:** 부모를 통해 참여한 n번째 노드 순번
  * **Aparent:** 부모 주소, **An:** n번째 엔드 디바이스 주소
* **예시 파라미터:** **Cm=3, Rm=3, Lm=3** 로 구성 예시와 **주소 할당 단계** 도식 제공.

---
